todo:
    - find out whats going on with the bug where some advertisements still get through
    - clean up the Video class, make sure videos are only loaded once
    - add a check (or filter) to prevent the static images being counted as videos
    - create a ruby method for downloading youtube videos, and managing disk space, deleting the oldest videos
false negatives:
    - j4GnypVUfBw

(using_atk_version): 1.0
(project):
    name: Expressions Dataset
    description: A Dataset of video clips for facial expressions
    
    paths: &paths
        video_source: ./collect_from_csv/videos.csv
        all_urls: ./automated_downloading/urls.json
        adblock: ./adblock
    
    commands: &commands
        download: python3 download.py videos.csv
        update_count: !language/ruby |
            require 'atk_toolbox'
            videos = CSV.read(Info.paths["video_source"])
            expressions = {}
            expression_helper = {}
            for each_key, each_value in Info["expressions"]
                expressions[each_key] = 0
                expression_helper[each_key] = Set.new
            end
            videos.shift
            for each in videos
                if each[0].is_a?(String)
                    label = each[0]
                    url = each[1]
                    expressions[label] = expressions[label] + 1
                    # assume 1 person per url
                    expression_helper[label].add(url)
                end
            end
            expressions = expressions.sort_by {|k, v| v }
            values = {}
            for each_key, each_value in expressions
                values[each_key] = {
                    "number_of_examples" => each_value,
                    "number_of_urls" => expression_helper[each_key].size
                }
            end
            # set all the values at one time
            Info.set_key(["expressions"], values)

    dependencies: &dependencies
        atk: 0.0.1
        ruby: 2.5.0
        python: 3.7.3
        ffmpeg: 4.1.4
        chromedriver: 76.0.3809
        {pip: 19.0.3}:
            youtube-dl: 2019.07.27
        {gem: 3.0.4}:
            selenium-webdriver: 3.142.3
            webdrivers: 4.1.2
            activesupport: 5.2.3
            nokogiri: 1.10.4
            statistics2: 0.54.0
            

    (advanced_setup):
        (paths):
            <<: *paths
        (put_new_dependencies_under): [(project), basic_info, dependencies]
        # caveats for a specific OS
        when(--os is 'mac'):
            (project_commands):
                <<: *commands
            (dependencies):
                <<: *dependencies
        when(--os is 'windows'):
            (project_commands):
                <<: *commands
            (dependencies):
                <<: *dependencies
        when(--os is 'linux'):
            (project_commands):
                <<: *commands
            (dependencies):
                <<: *dependencies


expressions:
    looking_at_source:
        number_of_examples: 0
        number_of_urls: 0
    slouching:
        number_of_examples: 0
        number_of_urls: 0
    chin_down:
        number_of_examples: 0
        number_of_urls: 0
    long_stare:
        number_of_examples: 0
        number_of_urls: 0
    squinting:
        number_of_examples: 1
        number_of_urls: 1
    o_shaped_lips:
        number_of_examples: 1
        number_of_urls: 1
    lean_forward:
        number_of_examples: 2
        number_of_urls: 2
    back_head_touch:
        number_of_examples: 6
        number_of_urls: 4
    forehead_touch:
        number_of_examples: 9
        number_of_urls: 6
    head_shake:
        number_of_examples: 9
        number_of_urls: 6
    pressed_eyebrows:
        number_of_examples: 9
        number_of_urls: 7
    head_nod:
        number_of_examples: 10
        number_of_urls: 6
    raised_eyebrows:
        number_of_examples: 14
        number_of_urls: 9
    chin_touch:
        number_of_examples: 17
        number_of_urls: 9
    blink:
        number_of_examples: 18
        number_of_urls: 11

common non-recorded expression:
  - smiles
  - sneer (muscles around nose)
  - hand gestures of various types
  - eye motions (thinking eyes)
  - full head/neck motions:
      - titing head to a side
      - pushing head forward or backwards
      - very small very quick tilt to one side ("well at least *that* worked")
  - the width of the eyes
  - shrug

challenges:
  - A bit discouraging with how non-binary expressions are. Forcing them into categories feels inaccurate
  - video contents:
      - multiple faces (very hard to get one face with genuine expressions)
      - people not directly facing the camera
      - glasses, headphones, hats, microphones
      - shaky video
      - lighting
      - |
        single faces are generally people actively talking or interviewing, not being passive.
        People who are passive are generally participating in something else, and usually that means other faces are on screen
        This means very little
      - face touching
      - neck touching
      - slouching/hunching

  - expressions often happen in well under 1 second
  - suprisingly hard to tell for some expressions. Some people/lighting makes it obvious and others make it very difficult
  - there's no great definition of an expression



